# Quanta 用户使用手册

## 目录

1. [产品简介](#1-产品简介)
2. [安装与运行](#2-安装与运行)
3. [快速开始](#3-快速开始)
4. [基本操作](#4-基本操作)
5. [命令管理](#5-命令管理)
6. [快捷键说明](#6-快捷键说明)
7. [功能特性](#7-功能特性)
8. [系统托盘](#8-系统托盘)
9. [主题设置](#9-主题设置)
10. [语言切换](#10-语言切换)
11. [高级功能](#11-高级功能)
12. [常见问题](#12-常见问题)
13. [技术规格](#13-技术规格)

---

## 1. 产品简介

### 1.1 关于 Quanta

Quanta 是一款轻量级的 Windows 快速启动器，旨在帮助用户快速访问常用程序、文件和系统功能。通过全局快捷键唤出搜索框，用户可以瞬间定位并启动目标程序或执行系统命令，大幅提升工作效率。

### 1.2 核心特性

- **全局快捷键唤出**：默认使用 Alt+Space 唤出搜索框，支持自定义修改
- **智能模糊搜索**：支持关键字、名称、描述的智能匹配，按匹配度和使用频率排序
- **多种命令类型**：支持 URL、程序、Shell 命令、目录浏览、计算器五种类型
- **参数模式**：支持动态参数传递，如搜索命令后输入参数执行
- **明暗主题**：支持浅色和深色主题，配置自动保存
- **多语言支持**：支持中文和英文界面
- **系统托盘**：最小化运行于托盘，右键菜单提供快捷操作

### 1.3 适用场景

- 快速启动常用应用程序（如浏览器、编辑器、终端等）
- 快速打开系统功能（如控制面板、任务管理器、服务管理等）
- 快速执行 Shell 命令（如 ping、ipconfig 等）
- 快速访问常用文件夹
- 快速进行数学计算和单位换算

---

## 2. 安装与运行

### 2.1 系统要求

| 项目 | 最低要求 | 推荐配置 |
|------|---------|---------|
| 操作系统 | Windows 10 (x64) | Windows 11 (x64) |
| 运行时 | .NET 8.0 Runtime | .NET 8.0 Runtime |
| 磁盘空间 | 50 MB | 100 MB |
| 内存 | 50 MB | 100 MB |

### 2.2 获取程序

您可以通过以下方式获取 Quanta：

1. **编译运行**：从源代码编译
   ```bash
   git clone <repo-url>
   cd Quanta
   dotnet build
   dotnet run
   ```

2. **直接运行**：使用已编译的可执行文件
   - 找到 `bin/Debug/net8.0-windows/Quanta.exe` 或发布版本

3. **发布版本**：
   ```bash
   dotnet publish -c Release -r win-x64
   ```
   产物位于 `bin/Release/net8.0-windows/win-x64/publish/`

### 2.3 首次运行

1. 确保已安装 .NET 8.0 Runtime
2. 运行 Quanta.exe
3. 程序将自动：
   - 创建系统托盘图标
   - 注册全局快捷键（默认 Alt+Space）
   - 加载配置文件（config.json）
   - 初始化内置命令库

### 2.4 退出程序

有两种方式退出程序：

1. **通过托盘图标**：右键托盘图标 → 选择"退出"
2. **通过任务管理器**：结束 Quanta.exe 进程

---

## 3. 快速开始

### 3.1 基本工作流程

Quanta 的基本使用流程非常简单：

1. **唤出搜索框**：按 `Alt+Space` 快捷键
2. **输入关键字**：输入要搜索的命令、程序或功能
3. **选择结果**：使用方向键或鼠标选择
4. **执行命令**：按 Enter 或单击执行

### 3.2 唤出与隐藏

| 操作 | 方法 |
|------|------|
| 唤出搜索框 | 按 `Alt+Space`（默认） |
| 隐藏搜索框 | 按 `Esc` 或点击窗口外部 |

### 3.3 搜索示例

以下是一些常用的搜索示例：

| 输入 | 匹配结果 | 说明 |
|------|---------|------|
| `cmd` | 命令提示符 | 打开 CMD 终端 |
| `notepad` | 记事本 | 打开记事本 |
| `calc` | 计算器 | 打开计算器 |
| `explorer` | 资源管理器 | 打开文件资源管理器 |
| `taskmgr` | 任务管理器 | 打开任务管理器 |
| `control` | 控制面板 | 打开控制面板 |
| `regedit` | 注册表编辑器 | 打开注册表 |
| `ping` | Ping 命令 | 执行 Ping 测试 |

---

## 4. 基本操作

### 4.1 搜索功能

#### 4.1.1 搜索规则

Quanta 采用模糊匹配算法，搜索时按以下优先级排序：

| 优先级 | 匹配类型 | 权重 |
|--------|---------|------|
| 1 | 完全匹配关键字 | 1.00 |
| 2 | 关键字前缀匹配 | 0.95 |
| 3 | 关键字包含匹配 | 0.90 |
| 4 | 名称包含匹配 | 0.85 |
| 5 | 描述包含匹配 | 0.80 |

当多个结果匹配时，使用频率高的命令会优先显示。

#### 4.1.2 搜索技巧

1. **精确匹配**：输入完整关键字可直接定位
2. **部分匹配**：输入部分关键字即可搜索相关结果
3. **模糊搜索**：支持拼音首字母、英文缩写等

### 4.2 结果选择

#### 4.2.1 键盘选择

| 按键 | 功能 |
|------|------|
| ↑ | 选择上一条结果 |
| ↓ | 选择下一条结果 |
| Enter | 执行选中命令 |
| Tab | 进入参数模式 |

#### 4.2.2 鼠标选择

- **单击**：选中结果
- **双击**：执行命令

#### 4.2.3 快捷编号

使用 `Ctrl+1` 到 `Ctrl+9` 可以直接执行对应编号的命令。

### 4.3 参数模式

当搜索到支持参数的命令时，可以按 Tab 进入参数输入模式：

1. 输入命令关键字（如 `g` 匹配到 Google 搜索）
2. 按 Tab 进入参数模式（显示 `g > `）
3. 输入参数（如 `rust`）
4. 按 Enter 执行（将执行 `https://www.google.com/search?q=rust`）

按 Backspace 可退回普通搜索模式。

---

## 5. 命令管理

### 5.1 打开命令设置

有两种方式打开命令设置界面：

1. **通过托盘图标**：右键托盘图标 → 选择"设置"
2. **通过搜索框**：右键搜索框图标 → 选择"设置"

### 5.2 命令设置界面

命令设置界面包含以下功能区域：

- **命令表格**：显示所有已配置的命令
- **工具栏**：添加、删除、导入、导出按钮
- **搜索框**：过滤命令列表
- **快捷键录制**：录制新的全局快捷键

### 5.3 添加新命令

1. 点击工具栏的"添加"按钮
2. 填写命令信息：
   - **关键字**：搜索触发词
   - **名称**：显示名称
   - **类型**：命令类型（Url/Program/Shell/Directory/Calculator）
   - **路径**：执行路径或 URL
3. 点击"保存"

### 5.4 命令类型说明

| 类型 | 说明 | 示例 |
|------|------|------|
| Url | 打开网页 | `https://www.google.com/search?q={param}` |
| Program | 启动程序 | `notepad.exe` |
| Shell | 执行命令 | `ping {param}` |
| Directory | 打开文件夹 | `C:\Users\Public` |
| Calculator | 计算表达式 | `{param}` |

### 5.5 参数占位符

在命令路径中可使用以下占位符：

| 占位符 | 说明 |
|--------|------|
| `{param}` | 用户输入的参数 |
| `{query}` | 用户输入的查询 |
| `{%p}` | 用户输入的参数（简写） |

### 5.6 命令属性

| 属性 | 说明 |
|------|------|
| Keyword | 搜索触发关键字 |
| Name | 命令显示名称 |
| Type | 命令类型 |
| Path | 执行路径或 URL |
| Arguments | 启动参数 |
| WorkingDirectory | 工作目录 |
| RunAsAdmin | 是否以管理员运行 |
| RunHidden | 是否隐藏窗口运行 |
| IconPath | 自定义图标（支持 emoji） |
| ParamPlaceholder | 自定义参数占位符 |
| Enabled | 是否启用 |
| Description | 命令描述 |

### 5.7 导入导出

#### 5.7.1 导出命令

1. 点击工具栏"导出"按钮
2. 选择保存位置
3. 命令将导出为 JSON 格式

#### 5.7.2 导入命令

1. 点击工具栏"导入"按钮
2. 选择要导入的 JSON 文件
3. 命令将被添加到列表

---

## 6. 快捷键说明

### 6.1 全局快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| Alt+Space | 唤出/隐藏搜索框 | 默认快捷键，可自定义 |

### 6.2 搜索框内快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| Enter | 执行选中命令 | 执行当前选中的命令 |
| Esc | 隐藏窗口 | 关闭搜索框 |
| Tab | 进入参数模式 | 当有匹配命令时 |
| Backspace | 退回普通搜索 | 参数模式下使用 |
| ↑ | 选择上一条 | 向上导航结果列表 |
| ↓ | 选择下一条 | 向下导航结果列表 |
| Ctrl+1~9 | 快速执行 | 直接执行对应编号的命令 |

### 6.3 自定义快捷键

可以在设置界面中修改全局快捷键：

1. 打开命令设置界面
2. 点击"录制快捷键"按钮
3. 按下要设置的快捷键组合
4. 快捷键将自动保存

---

## 7. 功能特性

### 7.1 内置命令

Quanta 预置了以下常用系统命令：

| 关键字 | 说明 | 功能 |
|--------|------|------|
| cmd | 命令提示符 | 打开 CMD 终端 |
| powershell | PowerShell | 打开 PowerShell |
| notepad | 记事本 | 打开记事本 |
| calc | 计算器 | 打开计算器 |
| explorer | 资源管理器 | 打开文件资源管理器 |
| taskmgr | 任务管理器 | 打开任务管理器 |
| control | 控制面板 | 打开控制面板 |
| regedit | 注册表编辑器 | 打开注册表 |
| services | 服务管理 | 打开服务管理器 |
| devmgmt | 设备管理器 | 打开设备管理器 |
| ping | Ping 命令 | 执行 Ping 测试 |
| ipconfig | IP 配置 | 显示 IP 配置信息 |
| tracert | 路由追踪 | 执行路由追踪 |
| nslookup | DNS 查询 | 执行 DNS 查询 |
| netstat | 网络状态 | 显示网络状态 |
| mspaint | 画图 | 打开画图程序 |

### 7.2 计算器功能

在搜索框中输入数学表达式即可计算：

| 输入 | 结果 |
|------|------|
| `calc 2+2` | 4 |
| `calc 100*5` | 500 |
| `calc sqrt(16)` | 4 |
| `calc 2^10` | 1024 |

### 7.3 单位换算功能

支持多种单位换算：

| 输入 | 说明 |
|------|------|
| `100 km to mile` | 公里转英里 |
| `100 cm to inch` | 厘米转英寸 |
| `100 kg to pound` | 公斤转磅 |
| `100 celsius to fahrenheit` | 摄氏度转华氏度 |

---

## 8. 系统托盘

### 8.1 托盘图标

Quanta 启动后会在系统托盘区域显示图标，图标功能说明：

- **左键单击**：无操作
- **左键双击**：显示主窗口
- **右键单击**：显示上下文菜单

### 8.2 托盘菜单

右键托盘图标显示以下菜单：

| 菜单项 | 功能 |
|--------|------|
| 设置 | 打开命令设置界面 |
| 语言 | 子菜单：中文/English |
| 关于 | 显示作者和联系方式 |
| 退出 | 退出程序 |

### 8.3 托盘行为

在设置中可以配置以下托盘行为：

| 设置项 | 说明 |
|--------|------|
| StartWithWindows | 开机自启动 |
| MinimizeToTray | 最小化到托盘 |
| CloseToTray | 关闭到托盘（不退出程序） |

---

## 9. 主题设置

### 9.1 切换主题

点击搜索框右上角的月亮/太阳图标可以切换主题：

- **月亮图标**：当前为浅色主题，点击切换到深色主题
- **太阳图标**：当前为深色主题，点击切换到浅色主题

### 9.2 主题类型

| 主题 | 说明 |
|------|------|
| Light | 浅色主题，白色背景 |
| Dark | 深色主题，深灰色背景 |

### 9.3 主题持久化

主题设置会自动保存到配置文件，重启程序后自动恢复上次使用的主题。

---

## 10. 语言切换

### 10.1 支持语言

Quanta 支持以下语言：

| 语言代码 | 语言名称 |
|---------|---------|
| zh-CN | 简体中文 |
| en-US | English |

### 10.2 切换语言

有两种方式切换语言：

1. **通过托盘菜单**：右键托盘图标 → 语言 → 选择语言
2. **通过设置界面**：打开设置 → 选择语言

### 10.3 语言持久化

语言设置会自动保存到配置文件，重启程序后自动恢复。

---

## 11. 高级功能

### 11.1 配置文件

Quanta 使用 JSON 格式的配置文件，主要包含以下内容：

```json
{
  "Version": "1.0",
  "Hotkey": {
    "Modifier": "Alt",
    "Key": "Space"
  },
  "Theme": "Light",
  "Commands": [],
  "CommandGroups": [],
  "AppSettings": {
    "StartWithWindows": false,
    "MinimizeToTray": true,
    "CloseToTray": true,
    "ShowInTaskbar": false,
    "MaxResults": 10,
    "Language": "zh-CN"
  }
}
```

### 11.2 配置文件位置

配置文件位于程序运行目录下的 `config.json` 文件。

### 11.3 使用频率追踪

Quanta 会自动记录每个命令的使用次数，使用频率高的命令会优先显示在搜索结果中。

使用频率数据存储在 `usage.json` 文件中。

### 11.4 开机自启动

可以在设置中启用开机自启动功能：

1. 打开设置界面
2. 找到"开机自启"选项
3. 勾选启用

启用后，程序将在 Windows 启动时自动运行。

---

## 12. 常见问题

### 12.1 程序无法启动

**问题**：双击 Quanta.exe 后程序无响应

**解决方法**：
1. 确认已安装 .NET 8.0 Runtime
2. 查看是否有其他程序占用相同端口
3. 查看日志文件排查错误

### 12.2 快捷键冲突

**问题**：Alt+Space 被其他程序占用

**解决方法**：
1. 关闭占用快捷键的其他程序
2. 在设置中修改 Quanta 的快捷键

### 12.3 搜索结果不显示

**问题**：输入关键字后没有结果显示

**解决方法**：
1. 确认命令已正确配置
2. 检查关键字拼写
3. 尝试使用不同的关键字搜索

### 12.4 命令执行失败

**问题**：命令执行后没有反应或报错

**解决方法**：
1. 检查命令路径是否正确
2. 确认程序文件存在
3. 尝试以管理员身份运行

### 12.5 托盘图标不显示

**问题**：系统托盘区域没有 Quanta 图标

**解决方法**：
1. 检查程序是否正在运行
2. 查看任务管理器确认进程存在
3. 重启程序

### 12.6 主题不生效

**问题**：切换主题后没有变化

**解决方法**：
1. 重新启动程序
2. 检查配置文件是否有误
3. 查看日志排查错误

---

## 13. 技术规格

### 13.1 技术栈

| 项目 | 技术 |
|------|------|
| 框架 | .NET 8.0 / WPF |
| 架构 | MVVM |
| 语言 | C# |
| UI 框架 | WPF (Windows Presentation Foundation) |

### 13.2 项目结构

```
Quanta/
├── App.xaml / App.xaml.cs     # 入口文件
├── Quanta.csproj              # 项目配置
├── config.json                # 用户配置
├── quanta.ico                 # 应用图标
├── Models/                    # 数据模型
├── ViewModels/                # 视图模型
├── Views/                     # 视图文件
├── Services/                  # 服务层
├── Helpers/                   # 辅助工具
└── Resources/                 # 资源文件
```

### 13.3 第三方依赖

| 包名 | 版本 | 用途 |
|------|------|------|
| CommunityToolkit.Mvvm | 8.2.2 | MVVM 框架 |
| System.Drawing.Common | 8.0.0 | 图形处理 |

### 13.4 日志位置

程序日志位于运行目录下的 `logs` 文件夹中。

### 13.5 联系支持

- 作者：yeal911
- 邮箱：yeal91117@gmail.com

---

## 附录

### 附录 A：快捷键一览表

| 快捷键 | 功能 |
|--------|------|
| Alt+Space | 唤出/隐藏搜索框 |
| Enter | 执行选中命令 |
| Esc | 隐藏窗口 |
| Tab | 进入参数模式 |
| Backspace | 退回普通搜索 |
| ↑ | 选择上一条 |
| ↓ | 选择下一条 |
| Ctrl+1~9 | 快速执行对应编号 |

### 附录 B：命令类型说明

| 类型 | 说明 | 示例 |
|------|------|------|
| Url | 打开网页 | `https://www.google.com` |
| Program | 启动程序 | `notepad.exe` |
| Shell | 执行命令 | `ping {param}` |
| Directory | 打开目录 | `C:\Users` |
| Calculator | 计算表达式 | `{param}` |

---

*文档版本：1.0*
*最后更新：2026年2月*
