# Quanta 用户手册

<p align="center">
  <a href="用户手册.md">中文</a> | <a href="User Manual.md">English</a> | <a href="Manual de Usuario.md">Español</a> | <a href="Benutzerhandbuch.md">Deutsch</a> | <a href="Manuel Utilisateur.md">Français</a> | <a href="Manuale Utente.md">Italiano</a> | <a href="ユーザーマニュアル.md">日本語</a> | <a href="사용자 매뉴얼.md">한국어</a> | <a href="Manual do Usuário.md">Português</a> | <a href="Руководство пользователя.md">Русский</a> | <a href="دليل المستخدم.md">العربية</a>
</p>

---

## 目录

1. [快速开始](#快速开始)
2. [核心操作](#核心操作)
3. [内置命令](#内置命令)
4. [智能输入](#智能输入)
5. [录音功能](#录音功能)
6. [剪贴板历史](#剪贴板历史)
7. [自定义命令](#自定义命令)
8. [设置参考](#设置参考)

---

## 快速开始

### 环境要求

- Windows 10 / 11（x64）
- [.NET 8.0 Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)

### 启动步骤

1. 运行 `Quanta.exe`，程序自动最小化到系统托盘
2. 按 `Alt+R`（默认快捷键）唤出搜索框
3. 直接输入关键字，结果实时出现
4. 按 `Enter` 执行选中项，按 `Esc` 收起窗口

> 提示：右键托盘图标可快速访问设置、切换语言、退出程序。

---

## 核心操作

### 快捷键一览

| 快捷键 | 功能 |
|--------|------|
| `Alt+R` | 唤出 / 隐藏主窗口（可在设置中自定义） |
| `Enter` | 执行当前选中的命令 |
| `Tab` | 进入参数模式（为命令追加参数） |
| `Esc` | 退出参数模式 / 隐藏窗口 |
| `↑` / `↓` | 在结果列表中上下移动 |
| `Ctrl+1~9` | 直接执行列表中第 N 个结果 |
| `Backspace` | 在参数模式下退回普通搜索 |

### 模糊搜索

无需精确拼写，Quanta 支持前缀模糊匹配：

- 输入 `rec` → 自动匹配 `record`、`regedit` 等
- 输入 `ps` → 匹配 `powershell`
- 输入 `tk` → 匹配 `taskmgr`（Task Manager）

搜索范围覆盖命令关键字、名称、描述，结果按匹配度评分并分组显示。

### 参数模式

适用于带 `{param}` 占位符的命令（如 Google 搜索、Ping 等）：

1. 搜索到目标命令（如 `g`）
2. 按 `Tab` 进入参数模式，输入框出现 `g >`
3. 输入参数（如 `rust programming`）
4. 按 `Enter` 执行：自动将参数代入并打开 Google 搜索

### Ctrl+数字 快捷执行

结果列表每项前显示序号 1~9，按 `Ctrl+1` 直接执行第一项，以此类推，无需移动光标。

---

## 内置命令

所有内置命令均支持模糊搜索。

### 命令行工具

| 关键字 | 说明 |
|--------|------|
| `cmd` | 打开命令提示符 |
| `powershell` | 打开 PowerShell |

### 常用应用

| 关键字 | 说明 |
|--------|------|
| `notepad` | 记事本 |
| `calc` | Windows 计算器 |
| `mspaint` | 画图 |
| `explorer` | 资源管理器 |
| `winrecord` | Windows 内置录音机 |

### 系统管理

| 关键字 | 说明 |
|--------|------|
| `taskmgr` | 任务管理器 |
| `devmgmt` | 设备管理器 |
| `services` | 服务管理 |
| `regedit` | 注册表编辑器 |
| `control` | 控制面板 |
| `emptybin` | 清空回收站（立即执行，无需确认） |

### 网络诊断

| 关键字 | 说明 |
|--------|------|
| `ipconfig` | 查看 IP 配置（在 PowerShell 中运行） |
| `ping` | Ping（支持参数模式：`ping > 8.8.8.8`） |
| `tracert` | 路由追踪 |
| `nslookup` | DNS 查询 |
| `netstat` | 查看网络连接状态 |

### 电源管理

| 关键字 | 说明 |
|--------|------|
| `lock` | 立即锁定屏幕 |
| `shutdown` | 10 秒后关机（可在弹出的命令行中取消） |
| `restart` | 10 秒后重启 |
| `sleep` | 进入睡眠状态 |

### 特色功能

| 关键字 | 说明 |
|--------|------|
| `record` | 启动 Quanta 录音面板 |
| `clip` | 搜索剪贴板历史记录 |

### Quanta 系统命令

| 关键字 | 说明 |
|--------|------|
| `setting` | 打开设置界面 |
| `about` | 关于程序 |
| `exit` | 退出 Quanta |
| `english` | 立即切换界面语言为英文 |
| `chinese` | 立即切换界面语言为中文 |
| `spanish` | 立即切换界面语言为西班牙语 |

---

## 智能输入

无需选择命令，直接在搜索框输入，Quanta 自动识别输入类型并实时计算展示结果。

### 数学计算

直接输入数学表达式：

| 输入示例 | 结果 |
|----------|------|
| `2+2*3` | `8` |
| `(100-32)/1.8` | `37.778` |
| `2^10` | `1024` |
| `15%4` | `3` |
| `3.14*5*5` | `78.5` |
| `-5+2` | `-3` |
| `2^-3` | `0.125` |
| `2^3^2` | `512` |

支持运算符：`+`、`-`、`*`、`/`、`%`（取余）、`^`（幂），并支持括号、浮点数与一元正负号（如 `-5`、`+3`）。

运算优先级：`^`（幂）> `* / %` > `+ -`；幂运算为右结合（如 `2^3^2 = 2^(3^2)`）。

按 `Enter` 自动将计算结果复制到剪贴板。

### 单位转换

格式：`数值 源单位 to 目标单位`

**长度**

| 输入 | 结果 |
|------|------|
| `100 km to miles` | `62.137 miles` |
| `5 ft to cm` | `152.4 cm` |
| `1 inch to mm` | `25.4 mm` |

**重量**

| 输入 | 结果 |
|------|------|
| `1 kg to lbs` | `2.205 lbs` |
| `500 g to oz` | `17.637 oz` |

**温度**

| 输入 | 结果 |
|------|------|
| `100 c to f` | `212 °F` |
| `30 f to c` | `-1.111 °C` |

**面积 / 体积**

| 输入 | 结果 |
|------|------|
| `1 acre to m2` | `4046.856 m²` |
| `1 gallon to l` | `3.785 l` |

### 汇率转换

格式：`数值 源货币 to 目标货币`

> 需先在设置 → 汇率面板 中填写 [exchangerate-api.com](https://www.exchangerate-api.com) API Key。

| 输入示例 | 输出示例 |
|----------|----------|
| `100 usd to cny` | `¥736.50 CNY` |
| `1000 cny to jpy` | `¥20,500 JPY` |
| `50 eur to gbp` | `£42.30 GBP` |

支持 40+ 种货币。汇率数据本地缓存，默认缓存 1 小时（可在设置中调整），超时后自动从 API 更新。

### 颜色转换

支持 HEX、RGB、HSL 三种格式互转，并在结果旁显示颜色色块预览：

| 输入 | 输出 |
|------|------|
| `#E67E22` | `rgb(230,126,34)  hsl(28,79%,52%)` |
| `rgb(230,126,34)` | `#E67E22  hsl(28,79%,52%)` |
| `hsl(28,79%,52%)` | `#E67E22  rgb(230,126,34)` |
| `255,165,0` | `#FFA500  hsl(38,100%,50%)` |

按 `Enter` 将 HEX 值复制到剪贴板。

### 文本工具

| 前缀 | 功能 | 示例输入 | 结果 |
|------|------|----------|------|
| `base64 文本` | Base64 编码 | `base64 hello` | `aGVsbG8=` |
| `base64d 文本` | Base64 解码 | `base64d aGVsbG8=` | `hello` |
| `md5 文本` | MD5 哈希 | `md5 hello` | `5d41402abc4b2a76b9719d911017c592` |
| `sha256 文本` | SHA-256 哈希 | `sha256 hello` | `2cf24dba5fb0a30e...` |
| `url 文本` | URL 编码（自动检测已编码则解码） | `url hello world` | `hello%20world` |
| `json JSON字符串` | JSON 格式化美化 | `json {"a":1,"b":2}` | 格式化后的多行 JSON |

按 `Enter` 将结果复制到剪贴板。

### Google 搜索

格式：`g 关键词`

```
g rust programming  →  在默认浏览器打开 Google 搜索结果
```

也可先输入 `g`，再按 `Tab` 进入参数模式后输入搜索词。

### PowerShell 直接执行

前缀 `>` 可直接执行 PowerShell 命令：

```
> Get-Process       →  显示所有进程
> dir C:\           →  列出 C 盘文件
> ping 8.8.8.8      →  执行 ping
```

### 二维码生成

输入超过阈值字符数（默认 20 个字符，可在设置中调整）的文本，自动生成二维码并复制到剪贴板，同时弹出 Toast 通知告知复制成功。

```
https://github.com/yeal911/Quanta   →  自动生成二维码图片并复制到剪贴板
```

---

## 录音功能

输入 `record` 启动录音面板（悬浮在屏幕顶部）。

### 录音参数

| 参数 | 可选项 | 推荐值 |
|------|--------|--------|
| 音源 | 麦克风 / 扬声器（系统音频）/ 麦克风+扬声器 | 根据用途选择 |
| 格式 | m4a（AAC）/ mp3 | m4a（质量更高） |
| 码率 | 32 / 64 / 96 / 128 / 160 kbps | 会议录音用 32kbps，音乐用 128kbps |
| 声道 | 单声道 / 立体声 | 会议录音用单声道 |

> 会议录音推荐配置：m4a、32kbps、单声道 → 1 小时约仅 14MB。

### 录音操作

1. 点击 **开始** 按钮开始录音，面板显示录音时长
2. 点击 **暂停** 暂停录音，再次点击 **恢复** 继续
3. 点击 **停止** 结束录音，文件自动保存到配置的输出目录
4. **右键点击参数切换**（音源、格式、码率、声道）可随时修改录音参数

### 录音输出

录音文件保存路径在设置 → 录音面板中配置，文件名格式为 `录音_YYYYMMDD_HHmmss.m4a`（或 `.mp3`）。

---

## 剪贴板历史

Quanta 在后台自动监听并记录复制到剪贴板的文本内容。

### 使用方式

- 输入 `clip` → 显示最近 20 条剪贴板历史
- 输入 `clip 关键字` → 按关键字筛选历史记录
- 点击任意结果 → 自动将内容复制回剪贴板

### 注意事项

- 最多保存 50 条历史记录（超出后自动删除最旧的）
- 历史数据持久化到本地，重启后依然保留
- 仅记录文本内容，不记录图片或文件

---

## 自定义命令

### 打开命令管理

输入 `setting` 或右键托盘图标 → 设置 → 切换到「命令管理」选项卡。

### 命令类型说明

| 类型 | 说明 | 路径示例 |
|------|------|----------|
| `Url` | 在默认浏览器中打开 URL，支持 `{param}` 参数占位符 | `https://google.com/search?q={param}` |
| `Program` | 启动可执行程序 | `C:\Windows\notepad.exe` 或 `notepad.exe` |
| `Shell` | 在 cmd 中执行命令，支持 `{param}` | `ping {param}` |
| `Directory` | 用资源管理器打开文件夹 | `C:\Users\Public\Downloads` |
| `Calculator` | 对输入内容求值（主要供高级用法） | `{param}` |

### 添加命令示例

**添加一个「打开项目目录」命令：**
1. 点击「添加」按钮
2. 关键字填 `proj`，名称填 `我的项目`，类型选 `Directory`，路径填 `D:\Projects`
3. 点击「保存」
4. 在搜索框输入 `proj` 即可快速打开

**添加一个「必应搜索」命令：**
1. 关键字填 `bing`，名称填 `必应搜索`，类型选 `Url`，路径填 `https://www.bing.com/search?q={param}`
2. 保存后，搜索 `bing`，按 `Tab` 输入搜索词即可

### 导入 / 导出

在命令管理选项卡中，可将所有自定义命令导出为 JSON 文件，方便备份或在多台电脑间迁移。

---

## 设置参考

打开方式：搜索框输入 `setting`，或右键托盘图标 → 设置。

### 通用设置

| 设置项 | 说明 |
|--------|------|
| 快捷键 | 自定义全局热键（默认 `Alt+R`），双击输入框后按目标组合键即可修改 |
| 主题 | Light（浅色）/ Dark（深色） |
| 语言 | 中文 / English / Español，切换即时生效 |
| 开机启动 | 开启后 Windows 启动时自动运行 Quanta |
| 最多显示 | 搜索结果数量上限 |
| 长文本转二维码 | 超过此字符数时自动生成二维码（默认 20） |

### 汇率设置

| 设置项 | 说明 |
|--------|------|
| 汇率 API Key | 在 [exchangerate-api.com](https://www.exchangerate-api.com) 注册获取免费 API Key |
| 缓存时长 | 汇率数据缓存有效期（小时），超出后重新调接口更新，默认 1 小时 |

### 录音设置

| 设置项 | 说明 |
|--------|------|
| 录音音源 | 麦克风 / 扬声器 / 两者同时 |
| 录音格式 | m4a（AAC，推荐）/ mp3 |
| 录音码率 | 32 / 64 / 96 / 128 / 160 kbps |
| 录音声道 | 单声道 / 立体声 |
| 录音输出路径 | 录音文件保存目录，点击「浏览」选择 |

---

## 常见问题

**Q: 按 Alt+R 没有反应怎么办？**
A: 检查是否有其他软件占用了 Alt+R 快捷键。打开设置修改为其他组合键（如 `Alt+Space`）。

**Q: 汇率转换一直提示「请配置 API Key」？**
A: 前往设置 → 汇率面板，填写从 exchangerate-api.com 获取的免费 API Key，然后点击保存。

**Q: 录音文件保存在哪里？**
A: 默认保存在用户文档目录。可在设置 → 录音面板 → 录音输出路径 中修改。

**Q: 如何取消关机/重启倒计时？**
A: 执行 `shutdown` 或 `restart` 命令后，会在 PowerShell 窗口倒计时 10 秒。在 10 秒内在 PowerShell 中执行 `shutdown /a` 即可取消。

---

*作者：**yeal911** · yeal91117@gmail.com · MIT License*
