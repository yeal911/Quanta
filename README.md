# Quanta - Windows å¿«é€Ÿå¯åŠ¨å™¨

<p align="center">
  <b>ä¸­æ–‡</b> | <a href="README_EN.md">English</a>
</p>

<p align="center">
  <img src="quanta.ico" width="64" alt="Quanta"/>
</p>

<p align="center">
  ä¸€æ¬¾è½»é‡çº§ Windows å¿«é€Ÿå¯åŠ¨å™¨ï¼Œå…¨å±€å¿«æ·é”®å”¤å‡ºï¼Œæ¨¡ç³Šæœç´¢ï¼Œç§’çº§æ‰§è¡Œã€‚
</p>

---

## ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [é…ç½®æ–‡ä»¶](#é…ç½®æ–‡ä»¶)
- [é¡¹ç›®è®¾è®¡](#é¡¹ç›®è®¾è®¡)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

---

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å…¨å±€å¿«æ·é”®å”¤å‡º** - é»˜è®¤ `Alt+Space`ï¼Œå¯è‡ªå®šä¹‰ä¿®æ”¹
- **æ¨¡ç³Šæœç´¢** - æ”¯æŒå…³é”®å­—ã€åç§°ã€æè¿°çš„æ™ºèƒ½æ¨¡ç³ŠåŒ¹é…ï¼ŒæŒ‰åŒ¹é…åˆ†+ä½¿ç”¨é¢‘ç‡æ’åº
- **è‡ªå®šä¹‰å‘½ä»¤** - æ”¯æŒ Urlã€Programã€Shellã€Directoryã€Calculator äº”ç§ç±»å‹
- **å‚æ•°æ¨¡å¼** - æŒ‰ `Tab` è¿›å…¥å‚æ•°è¾“å…¥æ¨¡å¼ï¼ŒåŠ¨æ€ä¼ å‚ï¼ˆå¦‚ `g > hello world`ï¼‰
- **Ctrl+æ•°å­—** - `Ctrl+1~9` ç›´æ¥æ‰§è¡Œå¯¹åº”åºå·å‘½ä»¤
- **é¼ æ ‡å•å‡»æ‰§è¡Œ** - æœç´¢ç»“æœæ”¯æŒå•å‡»ç›´æ¥æ‰§è¡Œ
- **å¤±ç„¦è‡ªåŠ¨éšè—** - ç‚¹å‡»å…¶ä»–çª—å£å³è‡ªåŠ¨æ”¶èµ·

### å†…ç½®ç³»ç»Ÿå‘½ä»¤

æ— éœ€é…ç½®ï¼Œç›´æ¥è¾“å…¥å…³é”®å­—å³å¯ä½¿ç”¨ï¼š

| å…³é”®å­— | è¯´æ˜ | å…³é”®å­— | è¯´æ˜ |
|--------|------|--------|------|
| `cmd` | å‘½ä»¤æç¤ºç¬¦ | `powershell` | PowerShell |
| `notepad` | è®°äº‹æœ¬ | `calc` | è®¡ç®—å™¨ |
| `explorer` | èµ„æºç®¡ç†å™¨ | `taskmgr` | ä»»åŠ¡ç®¡ç†å™¨ |
| `control` | æ§åˆ¶é¢æ¿ | `regedit` | æ³¨å†Œè¡¨ç¼–è¾‘å™¨ |
| `services` | æœåŠ¡ç®¡ç† | `devmgmt` | è®¾å¤‡ç®¡ç†å™¨ |
| `ping` | Ping | `ipconfig` | IP é…ç½® |
| `tracert` | è·¯ç”±è¿½è¸ª | `nslookup` | DNS æŸ¥è¯¢ |
| `netstat` | ç½‘ç»œçŠ¶æ€ | `mspaint` | ç”»å›¾ |

### ç•Œé¢ä¸ä½“éªŒ
- **æ˜æš—ä¸»é¢˜** - ç‚¹å‡»å³ä¸Šè§’å›¾æ ‡åˆ‡æ¢ï¼Œé…ç½®æŒä¹…åŒ–
- **å¤šè¯­è¨€** - ä¸­æ–‡ / Englishï¼Œåˆ‡æ¢å³æ—¶ç”Ÿæ•ˆ
- **ç³»ç»Ÿæ‰˜ç›˜** - æœ€å°åŒ–é©»ç•™æ‰˜ç›˜ï¼Œå³é”®èœå•ç®¡ç†
- **å¼€æœºè‡ªå¯** - é…ç½® `StartWithWindows` å†™å…¥æ³¨å†Œè¡¨
- **å‘½ä»¤å›¾æ ‡** - æ ¹æ®ç±»å‹è‡ªåŠ¨æ˜¾ç¤º emojiï¼Œæ”¯æŒè‡ªå®šä¹‰
- **Toast é€šçŸ¥** - æ“ä½œåé¦ˆï¼ˆä¿å­˜ã€å¯¼å…¥ã€é”™è¯¯ç­‰ï¼‰
- **æ·¡å…¥æ·¡å‡ºåŠ¨ç”»** - æ˜¾ç¤º/éšè—å¹³æ»‘è¿‡æ¸¡

### å‘½ä»¤ç®¡ç†
- **è®¾ç½®ç•Œé¢** - å¢åˆ æ”¹æŸ¥ï¼Œæ”¯æŒæœç´¢è¿‡æ»¤
- **å¿«æ·é”®è®¾ç½®** - ç•Œé¢å†…ç›´æ¥å½•åˆ¶ä¿®æ”¹
- **å¯¼å…¥/å¯¼å‡º** - JSON æ ¼å¼ï¼Œä¾¿äºåˆ†äº«å’Œå¤‡ä»½
- **MaxResults é…ç½®** - å¯è°ƒæœç´¢ç»“æœæœ€å¤§æ˜¾ç¤ºæ¡æ•°

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Windows 10 / 11ï¼ˆx64ï¼‰
- [.NET 8.0 Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)

### ç¼–è¯‘è¿è¡Œ

```bash
git clone <repo-url>
cd Quanta
dotnet build
dotnet run
```

### å‘å¸ƒå•æ–‡ä»¶

```bash
dotnet publish -c Release -r win-x64
```

äº§ç‰©ä½äº `bin/Release/net8.0-windows/win-x64/publish/`ã€‚

---

## ä½¿ç”¨è¯´æ˜

### åŸºæœ¬æ“ä½œ

1. å¯åŠ¨åç¨‹åºé©»ç•™ç³»ç»Ÿæ‰˜ç›˜
2. æŒ‰ `Alt+Space` å”¤å‡ºæœç´¢æ¡†
3. è¾“å…¥å‘½ä»¤å…³é”®å­—ï¼ˆå¦‚ `g`ã€`notepad`ï¼‰
4. æ–¹å‘é”®é€‰æ‹©æˆ– `Ctrl+æ•°å­—` ç›´æ¥å®šä½
5. `Enter` æ‰§è¡Œï¼Œ`Esc` éšè—

### å‚æ•°æ¨¡å¼

æœç´¢åˆ°å¸¦å‚æ•°çš„å‘½ä»¤åæŒ‰ `Tab` è¿›å…¥å‚æ•°æ¨¡å¼ï¼š

```
[æœç´¢æ¡†]: g           â†’ åŒ¹é…åˆ° Googleæœç´¢
æŒ‰ Tab  â†’ g >         â†’ è¿›å…¥å‚æ•°è¾“å…¥
è¾“å…¥    â†’ g > rust    â†’ æ‰§è¡Œ Google æœç´¢ "rust"
```

`Backspace` é€€å›æ™®é€šæœç´¢ï¼Œ`Esc` éšè—çª—å£ã€‚

### å¿«æ·é”®ä¸€è§ˆ

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `Alt+Space` | å”¤å‡º/éšè—ä¸»çª—å£ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ |
| `Enter` | æ‰§è¡Œé€‰ä¸­å‘½ä»¤ |
| `Tab` | è¿›å…¥å‚æ•°æ¨¡å¼ |
| `Esc` | é€€å‡ºå‚æ•°æ¨¡å¼ / éšè—çª—å£ |
| `â†‘` / `â†“` | é€‰æ‹©ä¸Š/ä¸‹ä¸€æ¡ç»“æœ |
| `Ctrl+1~9` | å¿«é€Ÿæ‰§è¡Œå¯¹åº”åºå·å‘½ä»¤ |
| `Backspace` | å‚æ•°æ¨¡å¼ä¸‹é€€å›æ™®é€šæœç´¢ |

### å‘½ä»¤ç®¡ç†

- **å³é”®æœç´¢å›¾æ ‡** æˆ– **å³é”®æ‰˜ç›˜å›¾æ ‡** â†’ æ‰“å¼€å‘½ä»¤è®¾ç½®
- è¡¨æ ¼å†…ç›´æ¥ç¼–è¾‘å…³é”®å­—ã€åç§°ã€ç±»å‹ã€è·¯å¾„
- æ”¯æŒ JSON å¯¼å…¥/å¯¼å‡ºï¼Œä¾¿äºå¤‡ä»½å’Œè¿ç§»

---

## é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä¸ºç¨‹åºç›®å½•ä¸‹çš„ `config.json`ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ï¼Œä¿®æ”¹åçƒ­é‡è½½ã€‚

### å®Œæ•´ç»“æ„

```json
{
  "Version": "1.0",
  "Hotkey": {
    "Modifier": "Alt",
    "Key": "Space"
  },
  "Theme": "Light",
  "Commands": [],
  "CommandGroups": [],
  "AppSettings": {
    "StartWithWindows": false,
    "MinimizeToTray": true,
    "CloseToTray": true,
    "ShowInTaskbar": false,
    "MaxResults": 10,
    "Language": "zh-CN",
    "AutoUpdate": true
  },
  "PluginSettings": {
    "Enabled": true,
    "PluginDirectory": "Plugins"
  }
}
```

### å‘½ä»¤å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|:----:|------|
| `Keyword` | string | âœ“ | æœç´¢è§¦å‘å…³é”®å­— |
| `Name` | string | âœ“ | å‘½ä»¤æ˜¾ç¤ºåç§° |
| `Type` | string | âœ“ | `Url` / `Program` / `Shell` / `Directory` / `Calculator` |
| `Path` | string | âœ“ | æ‰§è¡Œè·¯å¾„æˆ– URLï¼Œæ”¯æŒ `{param}` å ä½ç¬¦ |
| `Arguments` | string | | å¯åŠ¨å‚æ•°ï¼Œæ”¯æŒ `{param}` å ä½ç¬¦ |
| `WorkingDirectory` | string | | å·¥ä½œç›®å½• |
| `RunAsAdmin` | bool | | ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œé»˜è®¤ `false` |
| `RunHidden` | bool | | éšè—çª—å£è¿è¡Œï¼Œé»˜è®¤ `false` |
| `IconPath` | string | | è‡ªå®šä¹‰å›¾æ ‡ï¼Œæ”¯æŒ emojiï¼ˆå¦‚ `"ğŸš€"`ï¼‰ |
| `ParamPlaceholder` | string | | è‡ªå®šä¹‰å‚æ•°å ä½ç¬¦ï¼Œé»˜è®¤ `{param}` |
| `Enabled` | bool | | æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤ `true` |
| `Description` | string | | å‘½ä»¤æè¿°ï¼Œç”¨äºæ¨¡ç³Šæœç´¢åŒ¹é… |

### å‘½ä»¤ç±»å‹ç¤ºä¾‹

| ç±»å‹ | Path ç¤ºä¾‹ | æ•ˆæœ |
|------|-----------|------|
| `Url` | `https://www.google.com/search?q={param}` | æµè§ˆå™¨æ‰“å¼€ |
| `Program` | `notepad.exe` / `C:\Tools\app.exe` | å¯åŠ¨ç¨‹åº |
| `Shell` | `ping {param}` | cmd æ‰§è¡Œ |
| `Directory` | `C:\Users\Public` | èµ„æºç®¡ç†å™¨æ‰“å¼€ |
| `Calculator` | `{param}` | è®¡ç®—è¡¨è¾¾å¼ |

### å ä½ç¬¦è¯´æ˜

`{param}` / `{query}` / `{%p}` ä¸‰è€…ç­‰ä»·ï¼Œæ‰§è¡Œæ—¶æ›¿æ¢ä¸ºç”¨æˆ·è¾“å…¥çš„å‚æ•°ã€‚å¯é€šè¿‡ `ParamPlaceholder` å­—æ®µè‡ªå®šä¹‰å ä½ç¬¦åç§°ã€‚

### åº”ç”¨è®¾ç½®

| å­—æ®µ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `StartWithWindows` | `false` | å†™å…¥æ³¨å†Œè¡¨å®ç°å¼€æœºè‡ªå¯ |
| `MinimizeToTray` | `true` | æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜ |
| `CloseToTray` | `true` | å…³é—­æ—¶æ”¶å…¥æ‰˜ç›˜è€Œéé€€å‡º |
| `MaxResults` | `10` | æœç´¢ç»“æœæœ€å¤§æ¡æ•° |
| `Language` | `"zh-CN"` | `zh-CN` æˆ– `en-US` |

---

## é¡¹ç›®è®¾è®¡

### æ•´ä½“æ¶æ„

Quanta é‡‡ç”¨ **MVVM** æ¨¡å¼ï¼Œåˆ†ä¸ºå››å±‚ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  View å±‚                     â”‚
â”‚   MainWindow  Â·  CommandSettingsWindow        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ æ•°æ®ç»‘å®š / å‘½ä»¤
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ViewModel å±‚                   â”‚
â”‚             MainViewModel                    â”‚
â”‚  SearchText Â· Results Â· SelectedResult        â”‚
â”‚  IsParamMode Â· CommandKeyword Â· CommandParam  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Services å±‚                    â”‚
â”‚  SearchEngine  CommandRouter  UsageTracker   â”‚
â”‚  HotkeyManager  TrayService  ToastService    â”‚
â”‚  LocalizationService  ThemeService  Logger   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ è¯»å†™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Models / Data å±‚               â”‚
â”‚  AppConfig  CommandConfig  SearchResult      â”‚
â”‚  UsageData  Â·  config.json  Â·  usage.json   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—è¯¦è§£

#### SearchEngineï¼ˆæœç´¢å¼•æ“ï¼‰

æœç´¢çš„æ ¸å¿ƒè°ƒåº¦å™¨ï¼Œè´Ÿè´£ï¼š

1. **å†…å­˜å‘½ä»¤åº“** - å¯åŠ¨æ—¶åŠ è½½ `config.json` ä¸­çš„ç”¨æˆ·å‘½ä»¤å’Œå†…ç½®å‘½ä»¤åˆ°å†…å­˜ï¼Œè®¾ç½®ç•Œé¢å…³é—­åçƒ­é‡è½½
2. **åŒ¹é…è¯„åˆ†** - å¯¹æ¯æ¡å‘½ä»¤æŒ‰äº”çº§ä¼˜å…ˆçº§è¯„åˆ†ï¼š

   ```
   å®Œå…¨åŒ¹é…å…³é”®å­—   â†’ 1.00
   å…³é”®å­—å‰ç¼€åŒ¹é…   â†’ 0.95
   å…³é”®å­—åŒ…å«åŒ¹é…   â†’ 0.90
   åç§°åŒ…å«åŒ¹é…     â†’ 0.85
   æè¿°åŒ…å«åŒ¹é…     â†’ 0.80
   ```

3. **ç»“æœæ’åº** - æŒ‰ `(MatchScore â†“, UsageCount â†“)` åŒé”®æ’åºï¼Œè¿”å› Top Nï¼ˆN ç”± `MaxResults` é…ç½®ï¼‰
4. **å‘½ä»¤æ‰§è¡Œ** - æŒ‰ç±»å‹åˆ†æ´¾ï¼š
   - `Url` â†’ `Process.Start` æ‰“å¼€é»˜è®¤æµè§ˆå™¨
   - `Program` â†’ `ProcessStartInfo` å¯åŠ¨è¿›ç¨‹ï¼Œæ”¯æŒç®¡ç†å‘˜/éšè—æ¨¡å¼
   - `Shell` â†’ `cmd.exe /c` æ‰§è¡Œ
   - `Directory` â†’ `explorer.exe` æ‰“å¼€æ–‡ä»¶å¤¹
   - `Calculator` â†’ `DataTable.Compute` æ±‚å€¼

#### MainViewModelï¼ˆè§†å›¾æ¨¡å‹ï¼‰

ä½¿ç”¨ `CommunityToolkit.Mvvm` æ¡†æ¶ï¼Œæ ¸å¿ƒèŒè´£ï¼š

- **é˜²æŠ–æœç´¢** - è¾“å…¥å 30ms å»¶è¿Ÿè§¦å‘ï¼Œå–æ¶ˆä¸Šæ¬¡æœªå®Œæˆçš„æœç´¢ï¼ˆ`CancellationTokenSource`ï¼‰
- **å‚æ•°æ¨¡å¼** - ç»´æŠ¤ `IsParamMode` / `CommandKeyword` / `CommandParam` ä¸‰çŠ¶æ€
- **ç»“æœé€‰æ‹©** - å¾ªç¯å¯¼èˆªï¼ˆ`SelectNext` / `SelectPrevious`ï¼‰ï¼Œæ”¯æŒç´¢å¼•åŒæ­¥
- **æ¸…ç©ºçŠ¶æ€** - æ‰§è¡ŒæˆåŠŸå `ClearSearch()` é‡ç½®æ‰€æœ‰çŠ¶æ€

#### æœç´¢æ‰§è¡Œæ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
  â”‚
  â–¼
SearchBox (TwoWay Binding)
  â”‚
  â–¼
MainViewModel.OnSearchTextChanged
  â”‚  30ms é˜²æŠ–
  â–¼
SearchEngine.SearchAsync(query)
  â”œâ”€â”€ SearchCustomCommands(query)   // è‡ªå®šä¹‰ + å†…ç½®å‘½ä»¤
  â””â”€â”€ CommandRouter.TryHandleAsync  // ç‰¹æ®Šå‘½ä»¤ï¼ˆè®¡ç®—å™¨/ç½‘é¡µæœç´¢ï¼‰
  â”‚
  â–¼
Results æ’åº + ç´¢å¼•èµ‹å€¼
  â”‚
  â–¼
ObservableCollection<SearchResult> â†’ ListBox æ¸²æŸ“
```

#### HotkeyManagerï¼ˆå…¨å±€å¿«æ·é”®ï¼‰

é€šè¿‡ Win32 API `RegisterHotKey` / `UnregisterHotKey` å®ç°ç³»ç»Ÿçº§å¿«æ·é”®ï¼š

```csharp
// æ³¨å†Œçƒ­é”®åˆ°çª—å£æ¶ˆæ¯å¾ªç¯
RegisterHotKey(hwnd, HOTKEY_ID, modifiers, key);

// åœ¨ WndProc ä¸­ç›‘å¬ WM_HOTKEY æ¶ˆæ¯
HwndSource.AddHook(WndProc);
```

å¿«æ·é”®å¯åœ¨è®¾ç½®ç•Œé¢å®æ—¶å½•åˆ¶å¹¶ä¿®æ”¹ï¼Œä¿®æ”¹åç«‹å³é‡æ³¨å†Œã€‚

#### UsageTrackerï¼ˆä½¿ç”¨é¢‘ç‡è¿½è¸ªï¼‰

- æ¯æ¬¡å‘½ä»¤æ‰§è¡Œåè®°å½• `commandId â†’ timestamp`ï¼Œå­˜å‚¨åˆ° `LocalApplicationData/Quanta/usage.json`
- æ¯ 30 ç§’è‡ªåŠ¨è½ç›˜ï¼ˆé˜²æ­¢é¢‘ç¹ IOï¼‰
- æœç´¢æ—¶æŸ¥è¯¢ä½¿ç”¨æ¬¡æ•°ï¼Œä½œä¸ºç»“æœæ’åºçš„ç¬¬äºŒé”®
- é¢‘ç‡åŠ æƒå…¬å¼ï¼š`log10(usageCount + 1) * 0.5`ï¼ˆæ—¶é—´è¡°å‡åŠ æƒï¼‰

#### å‚æ•°æ¨¡å¼çŠ¶æ€æœº

```
æ™®é€šæœç´¢æ¨¡å¼
    â”‚ Tabï¼ˆåŒ¹é…åˆ°å‘½ä»¤ï¼‰
    â–¼
å‚æ•°è¾“å…¥æ¨¡å¼  â”€â”€Backspaceï¼ˆè¾“å…¥ä¸ºç©ºï¼‰â”€â”€â–¶  æ™®é€šæœç´¢æ¨¡å¼ï¼ˆä¿ç•™å…³é”®å­—ï¼‰
    â”‚ Enter
    â–¼
æ‰§è¡Œå‘½ä»¤ï¼ˆæ›¿æ¢ {param}ï¼‰
    â”‚ æˆåŠŸ
    â–¼
æ¸…ç©º â†’ éšè—çª—å£
```

#### å•å®ä¾‹ä¿è¯

```csharp
// å‘½å Mutex ç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹
var mutex = new Mutex(true, "Quanta_SingleInstance_Mutex", out bool createdNew);
if (!createdNew)
{
    // æ¿€æ´»å·²æœ‰å®ä¾‹çª—å£
    SetForegroundWindow(existingProcess.MainWindowHandle);
    Current.Shutdown();
}
```

#### å¤±ç„¦è‡ªåŠ¨éšè—

```csharp
private void Window_Deactivated(object sender, EventArgs e)
{
    // å¦‚æœæœ‰å­çª—å£æ‰“å¼€ï¼ˆå¦‚è®¾ç½®ç•Œé¢ï¼‰ï¼Œä¸éšè—
    if (OwnedWindows.Count > 0) return;
    HideWindow();
}
```

### æ–‡ä»¶ç»“æ„

```
Quanta/
â”œâ”€â”€ App.xaml / App.xaml.cs            # å…¥å£ã€å•å®ä¾‹æ£€æµ‹ã€å¼€æœºè‡ªå¯
â”œâ”€â”€ Quanta.csproj                      # é¡¹ç›®é…ç½®ï¼ˆ.NET 8, WPF, x64ï¼‰
â”œâ”€â”€ config.json                        # ç”¨æˆ·é…ç½®ï¼ˆè¿è¡Œç›®å½•ï¼‰
â”œâ”€â”€ quanta.ico                         # åº”ç”¨å›¾æ ‡ï¼ˆæ‰˜ç›˜ + çª—å£ï¼‰
â”‚
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ AppConfig.cs                   # æ ¹é…ç½®ã€å¿«æ·é”®ã€å‘½ä»¤ã€åº”ç”¨è®¾ç½®
â”‚   â”œâ”€â”€ SearchResult.cs                # æœç´¢ç»“æœã€ç»“æœç±»å‹æšä¸¾
â”‚   â””â”€â”€ UsageData.cs                   # ä½¿ç”¨é¢‘ç‡æ•°æ®ç»“æ„
â”‚
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ MainViewModel.cs               # æœç´¢çŠ¶æ€ã€å‚æ•°æ¨¡å¼ã€ä¸»é¢˜
â”‚
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ MainWindow.xaml / .cs          # ä¸»æœç´¢æ¡†ï¼Œé”®ç›˜äº‹ä»¶ï¼ŒåŠ¨ç”»
â”‚   â”œâ”€â”€ CommandSettingsWindow.xaml/.cs # å‘½ä»¤ç®¡ç†ï¼Œå¿«æ·é”®å½•åˆ¶
â”‚   â””â”€â”€ SettingsWindow.xaml / .cs      # é€šç”¨è®¾ç½®ï¼ˆé¢„ç•™æ‰©å±•ï¼‰
â”‚
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ SearchEngine.cs                # æœç´¢ã€åŒ¹é…è¯„åˆ†ã€å‘½ä»¤æ‰§è¡Œ
â”‚   â”œâ”€â”€ CommandRouter.cs               # ç‰¹æ®Šå‘½ä»¤è·¯ç”±ï¼ˆè®¡ç®—å™¨/ç½‘æœï¼‰
â”‚   â”œâ”€â”€ CommandService.cs              # å‘½ä»¤ JSON å¯¼å…¥/å¯¼å‡º
â”‚   â”œâ”€â”€ HotkeyManager.cs               # Win32 å…¨å±€å¿«æ·é”®
â”‚   â”œâ”€â”€ UsageTracker.cs                # ä½¿ç”¨é¢‘ç‡è®°å½•ã€æ’ååŠ æƒ
â”‚   â”œâ”€â”€ LocalizationService.cs         # å¤šè¯­è¨€ï¼ˆzh-CN / en-USï¼‰
â”‚   â”œâ”€â”€ TrayService.cs                 # ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ä¸èœå•
â”‚   â”œâ”€â”€ ToastService.cs                # Toast é€šçŸ¥ï¼ˆæˆåŠŸ/è­¦å‘Š/é”™è¯¯ï¼‰
â”‚   â”œâ”€â”€ ThemeService.cs                # æ˜æš—ä¸»é¢˜åˆ‡æ¢
â”‚   â”œâ”€â”€ WindowManager.cs               # çª—å£çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ PluginManager.cs               # æ’ä»¶æ‰©å±•ï¼ˆé¢„ç•™ï¼‰
â”‚   â””â”€â”€ Logger.cs                      # æ—¥å¿—ï¼ˆè°ƒè¯•æ§åˆ¶å°è¾“å‡ºï¼‰
â”‚
â”œâ”€â”€ Helpers/
â”‚   â””â”€â”€ ConfigLoader.cs                # é…ç½®æ–‡ä»¶åŠ è½½/ä¿å­˜/è¿ç§»/ç¼“å­˜
â”‚
â””â”€â”€ Resources/
    â””â”€â”€ Themes/
        â”œâ”€â”€ DarkTheme.xaml             # æš—è‰²ä¸»é¢˜èµ„æºå­—å…¸
        â””â”€â”€ LightTheme.xaml            # äº®è‰²ä¸»é¢˜èµ„æºå­—å…¸
```

### å…³é”®è®¾è®¡å†³ç­–

| å†³ç­– | æ–¹æ¡ˆ | åŸå›  |
|------|------|------|
| å‘½ä»¤æ‰§è¡Œæ–¹å¼ | Fire-and-forgetï¼ˆTask.Runï¼‰ | ä¸é˜»å¡ UIï¼Œæ‰§è¡ŒæˆåŠŸåå†éšè—çª—å£ |
| æœç´¢è§¦å‘ | 30ms é˜²æŠ– + CancellationToken | é¿å…é¢‘ç¹æœç´¢ï¼Œä¿è¯æœ€ç»ˆä¸€è‡´æ€§ |
| å†…ç½®å‘½ä»¤å­˜å‚¨ | ç¡¬ç¼–ç åœ¨ SearchEngine | ä¸æ±¡æŸ“ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œä¸å¯è¢«åˆ é™¤ |
| é…ç½®è¯»å– | å†…å­˜ç¼“å­˜ + Reload æœºåˆ¶ | é¿å…é¢‘ç¹ IOï¼Œè®¾ç½®å…³é—­åå¼ºåˆ¶åˆ·æ–° |
| å›¾æ ‡æ˜¾ç¤º | emoji å­—ç¬¦ | æ— éœ€å›¾ç‰‡èµ„æºï¼Œè·¨å­—ä½“æ¸²æŸ“ä¸€è‡´ |
| å¤±ç„¦éšè— | Deactivated + OwnedWindows æ£€æŸ¥ | æ‰“å¼€å­çª—å£æ—¶ä¸è¯¯éšè— |
| å•å®ä¾‹ | å‘½å Mutex | ç³»ç»Ÿçº§ä¿è¯ï¼Œè·¨è¿›ç¨‹å¯è§ |

---

## å¼€å‘æŒ‡å—

### ä¾èµ–

| åŒ… | ç‰ˆæœ¬ | ç”¨é€” |
|----|------|------|
| `CommunityToolkit.Mvvm` | 8.2.2 | MVVM åŸºç¡€æ¡†æ¶ï¼ˆObservableObject, RelayCommandï¼‰ |
| `System.Drawing.Common` | 8.0.0 | ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡å¤„ç† |

### æ·»åŠ æ–°å‘½ä»¤ç±»å‹

1. åœ¨ `AppConfig.cs` çš„ `CommandConfig.Type` æ³¨é‡Šä¸­è®°å½•æ–°ç±»å‹å
2. åœ¨ `SearchEngine.ExecuteCustomCommandAsync` çš„ `switch` ä¸­æ·»åŠ æ–° `case`
3. åœ¨ `SearchEngine.GetIconText` ä¸­æ·»åŠ å¯¹åº”å›¾æ ‡
4. åœ¨ `CommandSettingsWindow.xaml` çš„ `TypeColumn.ItemsSource` æ•°ç»„ä¸­æ·»åŠ æ–°ç±»å‹å

### æ·»åŠ æ–°ç¿»è¯‘é”®

åœ¨ `LocalizationService.cs` çš„ `_translations` å­—å…¸ä¸­åŒæ—¶æ·»åŠ  `zh-CN` å’Œ `en-US` æ¡ç›®ï¼š

```csharp
["zh-CN"] = new() { ["MyKey"] = "ä¸­æ–‡æ–‡æœ¬", ... },
["en-US"] = new() { ["MyKey"] = "English text", ... },
```

ç„¶ååœ¨å¯¹åº” UI ä»£ç ä¸­ä½¿ç”¨ `LocalizationService.Get("MyKey")`ã€‚

### è°ƒè¯•

```bash
dotnet run
```

æ—¥å¿—é€šè¿‡ `Logger.Log/Warn/Error` è¾“å‡ºåˆ° VS è°ƒè¯•æ§åˆ¶å°ï¼Œæ–¹ä¾¿è¿½è¸ªæœç´¢å’Œæ‰§è¡Œæµç¨‹ã€‚

---

## ä½œè€…

**yeal911** Â· yeal91117@gmail.com

## è®¸å¯è¯

MIT License
